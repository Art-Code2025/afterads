# دليل إعداد بوابة الدفع Paymob 💳

هذا الدليل يوضح لك كيفية إعداد بوابة الدفع Paymob خطوة بخطوة.

## 📋 الخطوات المطلوبة

### 1. إنشاء حساب Paymob
1. اذهب إلى [موقع Paymob](https://accept.paymob.com)
2. اضغط على "تسجيل" أو "Sign Up"
3. أدخل بيانات شركتك/متجرك
4. أكمل عملية التحقق

### 2. الحصول على بيانات API
بعد تسجيل الدخول إلى لوحة التحكم:

1. **API Key**: 
   - اذهب إلى Settings → API Keys
   - انسخ الـ API Key

2. **Secret Key**:
   - في نفس الصفحة، انسخ الـ Secret Key

3. **HMAC Secret**:
   - انسخ الـ HMAC Secret (مهم للأمان)

### 3. إعداد Integration
1. اذهب إلى "Integrations" في لوحة التحكم
2. اضغط على "Create Integration"
3. اختر "Online Card" للدفع بالبطاقات
4. انسخ الـ Integration ID

### 4. إعداد iFrame (اختياري)
إذا كنت تريد استخدام iFrame:
1. اذهب إلى "iFrames"
2. أنشئ iFrame جديد
3. انسخ الـ iFrame ID

### 5. إعداد ملف البيئة
1. انسخ ملف `.env.example` إلى `.env`:
   ```bash
   cp .env.example .env
   ```

2. أدخل بياناتك في ملف `.env`:
   ```env
   PAYMOB_API_KEY=pk_test_xxxxxxxxxxxxxxxx
   PAYMOB_SECRET_KEY=xxxxxxxxxxxxxxxx
   PAYMOB_HMAC_SECRET=xxxxxxxxxxxxxxxx
   PAYMOB_INTEGRATION_ID=123456
   PAYMOB_IFRAME_ID=123456
   SITE_URL=http://localhost:5173
   ```

### 6. تشغيل المشروع
```bash
# تثبيت المكتبات
npm install

# تشغيل المشروع
npm run dev
```

## 🧪 اختبار بوابة الدفع

### بطاقات اختبار Paymob:
- **Visa**: 4987654321098769
- **Mastercard**: 5123456789012346
- **CVV**: أي 3 أرقام
- **تاريخ الانتهاء**: أي تاريخ مستقبلي

### خطوات الاختبار:
1. أضف منتجات للسلة
2. اذهب للدفع
3. اختر "الدفع الإلكتروني"
4. استخدم بطاقة اختبار
5. تأكد من نجاح العملية

## 🔧 استكشاف الأخطاء

### خطأ "API Key غير صحيح":
- تأكد من نسخ API Key بشكل صحيح
- تأكد من عدم وجود مسافات إضافية

### خطأ "Integration ID غير موجود":
- تأكد من إنشاء Integration في لوحة التحكم
- تأكد من نسخ ID الصحيح

### خطأ "HMAC verification failed":
- تأكد من HMAC Secret الصحيح
- تأكد من عدم تعديل بيانات الطلب

### الدفع لا يعمل:
1. تحقق من console في المتصفح
2. تحقق من logs في Netlify Functions
3. تأكد من أن جميع URLs صحيحة

## 📞 الدعم

إذا واجهت أي مشاكل:
1. راجع [وثائق Paymob](https://docs.paymob.com)
2. تواصل مع دعم Paymob
3. تحقق من المنتديات والمجتمعات

## ⚠️ ملاحظات مهمة

1. **الأمان**: لا تشارك مفاتيح API مع أحد
2. **البيئة**: استخدم مفاتيح اختبار في التطوير
3. **الإنتاج**: غير جميع URLs للإنتاج قبل النشر
4. **النسخ الاحتياطي**: احتفظ بنسخة من مفاتيحك

## 🚀 الانتقال للإنتاج

عندما تكون جاهزاً للنشر:
1. احصل على مفاتيح الإنتاج من Paymob
2. غير SITE_URL إلى رابط موقعك
3. غير SUCCESS_URL و ERROR_URL
4. اختبر العملية مرة أخيرة
5. انشر الموقع

---

**تم إعداد بوابة الدفع بنجاح! 🎉**